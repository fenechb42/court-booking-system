
<!doctype html>
<html>
<head><title>Court Booking</title></head>
<body>
  <h2>Welcome, {{ user.name }} (<a href="{{ url_for('logout') }}">Logout</a>)</h2>
  <h3>Select a court on {{ date_str }}</h3>
  <form method="get">
    <select name="date" onchange="this.form.submit()">
      {% for d in next_7_days %}
        <option value="{{ d }}" {% if d == date_str %}selected{% endif %}>{{ d }}</option>
      {% endfor %}
    </select>
  </form>
  <table border="1">
    <tr><th>Time</th>{% for c in courts %}<th>Court {{ c }}</th>{% endfor %}</tr>
    {% for h in hours %}
    <tr>
      <td>{{ h }}:00</td>
      {% for c in courts %}
      <td>
        {% set key = 'court_' ~ c ~ '_hour_' ~ h %}
        {% if key in bookings %}
          Booked by {{ bookings[key].name }}
          {% if bookings[key].user == user_email or user.admin %}
            <form method="post"><input type="hidden" name="court" value="{{ c }}"><input type="hidden" name="hour" value="{{ h }}"><input type="hidden" name="action" value="cancel"><button type="submit">Cancel</button></form>
          {% endif %}
        {% else %}
          <form method="post"><input type="hidden" name="court" value="{{ c }}"><input type="hidden" name="hour" value="{{ h }}"><input type="hidden" name="action" value="book"><button type="submit">Book</button></form>
        {% endif %}
      </td>
      {% endfor %}
    </tr>
    {% endfor %}
  </table>
</body>
</html>
